---
/**
 * Flashcard Component
 *
 * An Astro component for defining flashcards with front and back content.
 * This component doesn't render anything visible - it's used to pass flashcard
 * data to the SpacedRepetition component.
 *
 * Usage:
 * <Flashcard id="card-1" front="Question?" back="Answer!" />
 *
 * With priority (higher number = higher priority, shown first):
 * <Flashcard id="card-important" front="Critical concept" back="Must learn first!" priority={100} />
 * <Flashcard id="card-normal" front="Regular concept" back="Learn this second" priority={10} />
 *
 * Or with HTML content:
 * <Flashcard id="card-2" priority={50}>
 *   <Fragment slot="front">
 *     <h3>What is FSRS?</h3>
 *     <p>Free Spaced Repetition Scheduler</p>
 *   </Fragment>
 *   <Fragment slot="back">
 *     <p>A modern spaced repetition algorithm...</p>
 *   </Fragment>
 * </Flashcard>
 */

interface Props {
    id: string;
    front?: string;
    back?: string;
    tags?: string[];
    source?: string;
    references?: string[];
    priority?: number; // Custom priority (higher = higher priority, default = 0)
}

const {
    id,
    front,
    back,
    tags = [],
    source,
    references = [],
    priority = 0,
} = Astro.props;

// Auto-detect source filename if not provided
let sourceFile = source;
if (!sourceFile) {
    // Get the filename from the call stack (Astro provides this via import.meta.url context)
    // Since we can't easily get the caller's filename in Astro, we'll extract it from the component's parent
    // For now, users should provide the source manually or we can leave it empty
    sourceFile = "";
}
---

<div
    class="flashcard-definition"
    data-id={id}
    data-tags={JSON.stringify(tags)}
    data-source={sourceFile}
    data-references={JSON.stringify(references)}
    data-priority={priority}
    style="display: none;"
>
    {front && <div class="front-simple" data-content={front} />}
    {back && <div class="back-simple" data-content={back} />}

    <div class="front-slot">
        <slot name="front" />
    </div>

    <div class="back-slot">
        <slot name="back" />
    </div>
</div>
